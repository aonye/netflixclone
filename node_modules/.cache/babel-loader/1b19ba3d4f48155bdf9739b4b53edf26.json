{"ast":null,"code":"var _jsxFileName = \"/home/yeandyy/Documents/the_odin_project/netflixclone/src/routing/Router.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { BrowserRouter, Route, Switch, Redirect, useHistory, withRouter } from 'react-router-dom';\nimport { doc, setDoc } from \"firebase/firestore\";\nimport { createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged } from \"firebase/auth\";\nimport { db, auth } from '../firebase/firebase';\nimport SignIn from '../components/SignIn';\nimport { SIError, SISuccess, SUError, SUSuccess } from '../components/AuthMsgs';\nimport SignUp from '../components/SignUp';\nimport Nav from '../components/Nav';\nimport films from '../assets/films/index';\nimport series from '../assets/series/index';\nimport Home from '../components/Home';\nimport Dashboard from '../components/Dashboard';\nimport Account from '../components/Account';\nimport Footer from '../components/Footer';\nimport { customMsg } from '../helper/helper';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Router = prop3000s => {\n  _s();\n\n  const [mediaType, setMediaType] = useState({\n    films\n  });\n  const [MTKey, setMTKey] = useState(Object.keys({\n    films\n  }));\n  const [authState, setAuthState] = useState(localStorage.getItem('authState'));\n  const [name, setName] = useState(null);\n  const [signInMsg, setSIMsg] = useState(null);\n  const [signUpMsg, setSUMsg] = useState(null); //console.log(authState, 'authstate');\n  //console.log(mediaType, MTKey, 'router');\n  //localStorage.clear();\n\n  onAuthStateChanged(auth, user => {\n    if (user) {\n      // User is signed in, see docs for a list of available properties\n      // https://firebase.google.com/docs/reference/js/firebase.User\n      const uid = user.uid;\n      saveUserInfo(uid, name);\n      console.log('authed, router.js');\n      setTimeout(() => {\n        setAuthState(true);\n      }, 2000);\n      localStorage.setItem('authState', true); // ...\n    } else {// User is signed out\n      // ...\n    }\n  });\n\n  async function saveUserInfo(uid, name) {\n    await setDoc(doc(db, 'netflix-users', `${uid}`), {\n      name\n    });\n  }\n\n  function PrivateRoute({\n    children,\n    ...rest\n  }) {\n    console.log('children:', children, 'rest:', rest, authState);\n    console.log(localStorage.getItem('authState'));\n    return /*#__PURE__*/_jsxDEV(Route, { ...rest,\n      render: () => {\n        return authState !== null ? children : /*#__PURE__*/_jsxDEV(Redirect, {\n          to: \"/\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 23\n        }, this);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 13\n    }, this);\n  }\n\n  async function createUser(email, password, name) {\n    createUserWithEmailAndPassword(auth, email, password).then(userCredential => {\n      const user = userCredential.user;\n      console.log(user, 'user/createdUser');\n      setName(name);\n      setSUMsg( /*#__PURE__*/_jsxDEV(SUSuccess, {\n        msg: customMsg('auth/sign-up-success')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 26\n      }, this));\n    }).catch(error => {\n      const errorCode = error.code;\n      const errorMessage = error.message;\n      console.log('error occured', errorCode, errorMessage);\n      setSUMsg( /*#__PURE__*/_jsxDEV(SUError, {\n        msg: customMsg(errorCode)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 26\n      }, this));\n    });\n  }\n\n  async function signInUser(email, password) {\n    signInWithEmailAndPassword(auth, email, password).then(userCredential => {\n      console.log('sign in successful', userCredential.user);\n      setSIMsg( /*#__PURE__*/_jsxDEV(SISuccess, {\n        msg: customMsg('auth/sign-in-success')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 26\n      }, this));\n    }).catch(error => {\n      const errorCode = error.code;\n      const errorMessage = error.message;\n      console.log('sign in error', error, errorCode, errorMessage);\n      setSIMsg( /*#__PURE__*/_jsxDEV(SIError, {\n        msg: customMsg(errorCode)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 26\n      }, this));\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(BrowserRouter, {\n    children: /*#__PURE__*/_jsxDEV(Switch, {\n      children: [/*#__PURE__*/_jsxDEV(Route, {\n        exact: true,\n        path: \"/\",\n        children: authState === null ? /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(Nav, {\n            setEmail: setEmail,\n            showSignInBtn: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(Home, {\n            email: email,\n            setEmail: setEmail\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 29\n        }, this) : /*#__PURE__*/_jsxDEV(Redirect, {\n          to: \"/dashboard\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(PrivateRoute, {\n        exact: true,\n        path: \"/dashboard\",\n        children: [/*#__PURE__*/_jsxDEV(Nav, {\n          setEmail: setEmail,\n          setAuthState: setAuthState,\n          setMediaType: setMediaType,\n          setMTKey: setMTKey,\n          films: films,\n          series: series,\n          showNavMB: true,\n          showProfile: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Dashboard, {\n          mediaType: mediaType,\n          MTKey: MTKey\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(Nav, {\n          setEmail: setEmail\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/signin\",\n          children: authState === null ? /*#__PURE__*/_jsxDEV(SignIn, {\n            signInUser: signInUser,\n            signInMsg: signInMsg,\n            setSIMsg: setSIMsg\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 29\n          }, this) : /*#__PURE__*/_jsxDEV(Redirect, {\n            to: \"/dashboard\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 31\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/signup\",\n          children: authState === null ? /*#__PURE__*/_jsxDEV(SignUp, {\n            createUser: createUser,\n            signUpMsg: signUpMsg,\n            setSUMsg: setSUMsg\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 29\n          }, this) : /*#__PURE__*/_jsxDEV(Redirect, {\n            to: \"/dashboard\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 31\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/account\",\n          children: /*#__PURE__*/_jsxDEV(Account, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Router, \"Eo0BYwrfcBqC/rOQXYynG2i6ZOk=\");\n\n_c = Router;\nexport default _c2 = withRouter(Router);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Router\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["/home/yeandyy/Documents/the_odin_project/netflixclone/src/routing/Router.js"],"names":["React","useEffect","useState","BrowserRouter","Route","Switch","Redirect","useHistory","withRouter","doc","setDoc","createUserWithEmailAndPassword","signInWithEmailAndPassword","onAuthStateChanged","db","auth","SignIn","SIError","SISuccess","SUError","SUSuccess","SignUp","Nav","films","series","Home","Dashboard","Account","Footer","customMsg","Router","prop3000s","mediaType","setMediaType","MTKey","setMTKey","Object","keys","authState","setAuthState","localStorage","getItem","name","setName","signInMsg","setSIMsg","signUpMsg","setSUMsg","user","uid","saveUserInfo","console","log","setTimeout","setItem","PrivateRoute","children","rest","createUser","email","password","then","userCredential","catch","error","errorCode","code","errorMessage","message","signInUser","setEmail"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { BrowserRouter, Route, Switch, Redirect, useHistory, withRouter } from 'react-router-dom';\nimport { doc, setDoc } from \"firebase/firestore\";\nimport { createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged } from \"firebase/auth\";\nimport { db, auth } from '../firebase/firebase';\nimport SignIn from '../components/SignIn';\nimport { SIError, SISuccess, SUError, SUSuccess } from '../components/AuthMsgs';\nimport SignUp from '../components/SignUp';\nimport Nav from '../components/Nav';\nimport films from '../assets/films/index';\nimport series from '../assets/series/index';\nimport Home from '../components/Home';\nimport Dashboard from '../components/Dashboard';\nimport Account from '../components/Account';\nimport Footer from '../components/Footer';\nimport { customMsg } from '../helper/helper';\n\nconst Router = (prop3000s) => {\n    const [mediaType, setMediaType] = useState({ films });\n    const [MTKey, setMTKey] = useState(Object.keys({ films }));\n    const [authState, setAuthState] = useState(localStorage.getItem('authState'));\n    const [name, setName] = useState(null);\n    const [signInMsg, setSIMsg] = useState(null);\n    const [signUpMsg, setSUMsg] = useState(null);\n\n    //console.log(authState, 'authstate');\n    //console.log(mediaType, MTKey, 'router');\n\n    //localStorage.clear();\n\n    onAuthStateChanged(auth, (user) => {\n        if (user) {\n            // User is signed in, see docs for a list of available properties\n            // https://firebase.google.com/docs/reference/js/firebase.User\n            const uid = user.uid;\n            saveUserInfo(uid, name);\n            console.log('authed, router.js');\n            setTimeout(() => {\n                setAuthState(true);\n            }, 2000);\n            localStorage.setItem('authState', true);\n            // ...\n        } else {\n            // User is signed out\n            // ...\n        }\n    });\n\n    async function saveUserInfo(uid, name) {\n        await setDoc(doc(db, 'netflix-users', `${uid}`), {\n            name\n        });\n    }\n\n    function PrivateRoute({ children, ...rest }) {\n        console.log('children:', children, 'rest:', rest, authState);\n        console.log(localStorage.getItem('authState'));\n        return (\n            <Route {...rest} render={() => {\n                return authState !== null\n                    ? children\n                    : <Redirect to='/' />\n            }} />\n        )\n    }\n\n    async function createUser(email, password, name) {\n        createUserWithEmailAndPassword(auth, email, password)\n            .then((userCredential) => {\n                const user = userCredential.user;\n                console.log(user, 'user/createdUser');\n                setName(name);\n                setSUMsg(<SUSuccess msg={customMsg('auth/sign-up-success')} />);\n            })\n            .catch((error) => {\n                const errorCode = error.code;\n                const errorMessage = error.message;\n                console.log('error occured', errorCode, errorMessage);\n                setSUMsg(<SUError msg={customMsg(errorCode)} />)\n            });\n\n    }\n\n    async function signInUser(email, password) {\n        signInWithEmailAndPassword(auth, email, password)\n            .then((userCredential) => {\n                console.log('sign in successful', userCredential.user);\n                setSIMsg(<SISuccess msg={customMsg('auth/sign-in-success')} />);\n            })\n            .catch((error) => {\n                const errorCode = error.code;\n                const errorMessage = error.message;\n                console.log('sign in error', error, errorCode, errorMessage);\n                setSIMsg(<SIError msg={customMsg(errorCode)} />);\n            });\n    }\n\n    return (\n        <BrowserRouter>\n            <Switch>\n                <Route exact path='/'>\n                    {authState === null ?\n                        (\n                            <div>\n                                <Nav setEmail={setEmail} showSignInBtn={true} />\n                                <Home email={email} setEmail={setEmail} />\n                                <Footer />\n                            </div>\n                        ) :\n                        <Redirect to='/dashboard' />\n                    }\n                </Route>\n                <PrivateRoute exact path='/dashboard'>\n                    <Nav\n                        setEmail={setEmail}\n                        setAuthState={setAuthState}\n                        setMediaType={setMediaType}\n                        setMTKey={setMTKey}\n                        films={films}\n                        series={series}\n                        showNavMB={true}\n                        showProfile={true}\n                    />\n                    <Dashboard mediaType={mediaType} MTKey={MTKey} />\n                    <Footer />\n                </PrivateRoute>\n                <div>\n                    <Nav setEmail={setEmail} />\n\n                    <Route exact path='/signin'>\n                        {authState === null ?\n                            <SignIn\n                                signInUser={signInUser}\n                                signInMsg={signInMsg}\n                                setSIMsg={setSIMsg}\n                            />\n                            : <Redirect to='/dashboard' />\n                        }\n                    </Route>\n                    <Route exact path='/signup'>\n                        {authState === null ?\n                            <SignUp\n                                createUser={createUser}\n                                signUpMsg={signUpMsg}\n                                setSUMsg={setSUMsg}\n                            />\n                            : <Redirect to='/dashboard' />\n                        }\n                    </Route>\n                    <Route exact path='/account'>\n                        <Account />\n                    </Route>\n\n                    <Footer />\n                </div>\n            </Switch>\n        </BrowserRouter >\n    );\n};\n\nexport default withRouter(Router);"]},"metadata":{},"sourceType":"module"}