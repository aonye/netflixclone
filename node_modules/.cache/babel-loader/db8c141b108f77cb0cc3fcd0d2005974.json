{"ast":null,"code":"import _regeneratorRuntime from\"/home/yeandyy/Documents/the_odin_project/netflixclone/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/yeandyy/Documents/the_odin_project/netflixclone/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/yeandyy/Documents/the_odin_project/netflixclone/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useRef,useState}from'react';import{auth}from'../firebase/firebase';import{Link,useHistory}from'react-router-dom';import{customMsg}from'../helper/helper';import{updateProfile,reauthenticateWithCredential,EmailAuthProvider}from\"firebase/auth\";import AuthMsg from'./AuthMsg';import'../styles/Username.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Username=function Username(_ref){var name=_ref.name,setName=_ref.setName;var nameField=useRef();var currentPw=useRef();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var history=useHistory();function redirectDash(){history.push(\"dashboard\");}function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var cred;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();cred=EmailAuthProvider.credential(auth.currentUser.email,currentPw.current.value);reauthenticateWithCredential(auth.currentUser,cred).then(function(){// User re-authed.\nupdateProfile(auth.currentUser,{displayName:nameField.current.value}).then(function(){console.log('success');console.log(nameField.current.value);setName(nameField.current.value);redirectDash();}).catch(function(error){setError(/*#__PURE__*/_jsx(AuthMsg,{useClass:\"auth-error\",msg:customMsg(\"\".concat(error))}));});}).catch(function(error){// An error ocurred\nif(error.code){setError(/*#__PURE__*/_jsx(AuthMsg,{useClass:\"auth-error\",msg:customMsg(error.code)}));}return;});case 3:case\"end\":return _context.stop();}}},_callee);}));return _handleSubmit.apply(this,arguments);}return/*#__PURE__*/_jsxs(\"div\",{className:\"username\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"username-container\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Update Username\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"Leave 'new' field blank if not updating\"})]}),error,/*#__PURE__*/_jsxs(\"form\",{onSubmit:function onSubmit(e){return handleSubmit(e);},children:[/*#__PURE__*/_jsx(\"label\",{children:\"Current Password\"}),/*#__PURE__*/_jsx(\"input\",{ref:currentPw,type:\"password\",placeholder:\"Current Password\",required:true}),/*#__PURE__*/_jsx(\"label\",{children:\"New Name\"}),/*#__PURE__*/_jsx(\"input\",{ref:nameField,type:\"text\",placeholder:\"First Name\",defaultValue:name}),/*#__PURE__*/_jsx(\"input\",{id:\"username-submit\",type:\"submit\",value:\"Submit\"}),/*#__PURE__*/_jsx(Link,{to:\"/dashboard\",children:\"Go back\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"overlay\"})]});};export default Username;","map":{"version":3,"sources":["/home/yeandyy/Documents/the_odin_project/netflixclone/src/components/Username.js"],"names":["useRef","useState","auth","Link","useHistory","customMsg","updateProfile","reauthenticateWithCredential","EmailAuthProvider","AuthMsg","Username","name","setName","nameField","currentPw","error","setError","history","redirectDash","push","handleSubmit","e","preventDefault","cred","credential","currentUser","email","current","value","then","displayName","console","log","catch","code"],"mappings":"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","sourcesContent":["import { useRef, useState } from 'react';\nimport { auth } from '../firebase/firebase';\nimport { Link, useHistory } from 'react-router-dom';\nimport { customMsg } from '../helper/helper';\nimport {\n    updateProfile,\n    reauthenticateWithCredential,\n    EmailAuthProvider,\n} from \"firebase/auth\";\nimport AuthMsg from './AuthMsg';\nimport '../styles/Username.css';\n\nconst Username = ({ name, setName }) => {\n    const nameField = useRef();\n    const currentPw = useRef();\n    const [error, setError] = useState(null);\n    const history = useHistory();\n\n    function redirectDash() {\n        history.push(`dashboard`);\n    }\n\n    async function handleSubmit(e) {\n        e.preventDefault();\n        const cred = EmailAuthProvider.credential(auth.currentUser.email, currentPw.current.value);\n        reauthenticateWithCredential(auth.currentUser, cred).then(() => {\n            // User re-authed.\n            updateProfile(auth.currentUser, { displayName: nameField.current.value })\n                .then(() => {\n                    console.log('success');\n                    console.log(nameField.current.value);\n                    setName(nameField.current.value);\n                    redirectDash();\n                })\n                .catch((error) => {\n                    setError(<AuthMsg useClass={`auth-error`} msg={customMsg(`${error}`)} />);\n                })\n        }).catch((error) => {\n            // An error ocurred\n            if (error.code) {\n                setError(<AuthMsg useClass={`auth-error`} msg={customMsg(error.code)} />);\n            }\n            return;\n        });\n    }\n\n    return (\n        <div className='username'>\n            <div className='username-container'>\n                <div>\n                    <h1>Update Username</h1>\n                    <h2>Leave 'new' field blank if not updating</h2>\n                </div>\n                {error}\n                <form onSubmit={(e) => handleSubmit(e)}>\n                    <label>Current Password</label>\n                    <input ref={currentPw} type='password' placeholder='Current Password' required></input>\n                    <label>New Name</label>\n                    <input ref={nameField} type='text' placeholder='First Name' defaultValue={name}></input>\n                    <input id='username-submit' type='submit' value='Submit'></input>\n                    <Link to='/dashboard'>Go back</Link>\n                </form>\n            </div>\n            <div className='overlay'></div>\n        </div >\n    );\n};\n\nexport default Username;"]},"metadata":{},"sourceType":"module"}